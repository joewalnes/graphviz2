% Remember to use the lgrind style

\Head{}
\File{sccmap.c}{2002}{7}{10}{15:30}{7815}
\L{\LB{\C{}/*}}
\L{\LB{}\Tab{4}{This_software_may_only_be_used_by_you_under_license_from_AT\&T_Corp.}}
\L{\LB{}\Tab{4}{(\3AT\&T\3).}\Tab{15}{A_copy_of_AT\&T{'}s_Source_Code_Agreement_is_available_at}}
\L{\LB{}\Tab{4}{AT\&T{'}s_Internet_website_having_the_URL:}}
\L{\LB{}\Tab{4}{\<http://www.research.att.com/sw/tools/graphviz/license/source.html\>}}
\L{\LB{}\Tab{4}{If_you_received_this_software_without_first_entering_into_a_license}}
\L{\LB{}\Tab{4}{with_AT\&T,_you_have_an_infringing_copy_of_this_software_and_cannot_use}}
\L{\LB{}\Tab{4}{it_without_violating_AT\&T{'}s_intellectual_property_rights.}}
\L{\LB{*/\CE{}}}
\L{\LB{}}
\L{\LB{\C{}/*}}
\L{\LB{_*_Written_by_Stephen_North}}
\L{\LB{_*_Updated_by_Emden_Gansner}}
\L{\LB{_*/\CE{}}}
\L{\LB{}}
\L{\LB{\C{}/*}}
\L{\LB{_*_This_is_a_filter_that_reads_a_graph,_searches_for_strongly}}
\L{\LB{_*_connected_components,_and_writes_each_as_a_separate_graph}}
\L{\LB{_*_along_with_a_map_of_the_components.}}
\L{\LB{_*/\CE{}}}
\L{\LB{\K{\#ifdef}_\V{HAVE\_CONFIG\_H}}}
\L{\LB{\K{\#include}_\<\V{gvconfig}.\V{h}\>}}
\L{\LB{\K{\#endif}}}
\L{\LB{}}
\L{\LB{\K{\#include}_\<\V{stdio}.\V{h}\>}}
\L{\LB{\K{\#ifdef}_\V{HAVE\_UNISTD\_H}}}
\L{\LB{\K{\#include}}\Tab{16}{\<\V{unistd}.\V{h}\>}}
\L{\LB{\K{\#endif}}}
\L{\LB{\K{\#include}_\<\V{agraph}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{ingraphs}.\V{h}\>}}
\L{\LB{}}
\L{\LB{\K{\#ifndef}_\V{HAVE\_GETOPT\_DECL}}}
\L{\LB{\K{\#include}_\<\V{getopt}.\V{h}\>}}
\L{\LB{\K{\#endif}}}
\L{\LB{}}
\L{\LB{\K{\#define}_\V{INF}_((\K{unsigned}_\K{int})(\-\N{1}))}}
\L{\LB{}}
\L{\LB{\K{typedef}_\K{struct}_\V{Agraphinfo\_t}_\{}}
\L{\LB{}\Tab{4}{\V{Agrec\_t}}\Tab{19}{\V{h};}}
\L{\LB{}\Tab{4}{\V{Agnode\_t}*}\Tab{19}{\V{rep};}}
\L{\LB{\}_\V{Agraphinfo\_t};}}
\L{\LB{}}
\L{\LB{\K{typedef}_\K{struct}_\V{Agnodeinfo\_t}_\{}}
\L{\LB{}\Tab{4}{\V{Agrec\_t}}\Tab{19}{\V{h};}}
\L{\LB{}\Tab{4}{\K{unsigned}_\K{int}}\Tab{19}{\V{val};}}
\L{\LB{}\Tab{4}{\V{Agraph\_t}*}\Tab{19}{\V{scc};}}
\L{\LB{\}_\V{Agnodeinfo\_t};}}
\L{\LB{}}
\L{\LB{\K{\#ifdef}_\V{INLINE}}}
\L{\LB{\K{\#define}_\V{getrep}(\V{g})}\Tab{19}{(((\V{Agraphinfo\_t}*)(\V{g}\-\!\>\V{base}.\V{data}))\-\!\>\V{rep})}}
\L{\LB{\K{\#define}_\V{setrep}(\V{g},\V{rep})}\Tab{23}{(\V{getrep}(\V{g})_=_\V{rep})}}
\L{\LB{\K{\#define}_\V{getscc}(\V{n})}\Tab{21}{(((\V{Agnodeinfo\_t}*)((\V{n})\-\!\>\V{base}.\V{data}))\-\!\>\V{scc})}}
\L{\LB{\K{\#define}_\V{setscc}(\V{n},\V{sub})}\Tab{25}{(\V{getscc}(\V{n})_=_\V{sub})}}
\L{\LB{\K{\#define}_\V{getval}(\V{n})}\Tab{21}{(((\V{Agnodeinfo\_t}*)((\V{n})\-\!\>\V{base}.\V{data}))\-\!\>\V{val})}}
\L{\LB{\K{\#define}_\V{setval}(\V{n},\V{newval})}\Tab{28}{(\V{getval}(\V{n})_=_\V{newval})}}
\L{\LB{\K{\#else}}}
\L{\LB{\K{static}_\V{Agnode\_t}_*}}
\index{getrep}\Proc{getrep}\L{\LB{\V{getrep}(\V{Agraph\_t}_*\V{g})_}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{return}_(((\V{Agraphinfo\_t}*)(\V{g}\-\!\>\V{base}.\V{data}))\-\!\>\V{rep});}}
\L{\LB{\}}}
\L{\LB{\K{static}_\K{void}_}}
\index{setrep}\Proc{setrep}\L{\LB{\V{setrep}(\V{Agraph\_t}_*\V{g},_\V{Agnode\_t}_*\V{rep})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{((\V{Agraphinfo\_t}*)(\V{g}\-\!\>\V{base}.\V{data}))\-\!\>\V{rep}_=_\V{rep};}}
\L{\LB{\}}}
\L{\LB{\K{static}_\V{Agraph\_t}_*}}
\index{getscc}\Proc{getscc}\L{\LB{\V{getscc}(\V{Agnode\_t}_*\V{n})_}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{return}_(((\V{Agnodeinfo\_t}*)(\V{n}\-\!\>\V{base}.\V{data}))\-\!\>\V{scc});}}
\L{\LB{\}}}
\L{\LB{\K{static}_\K{void}_}}
\index{setscc}\Proc{setscc}\L{\LB{\V{setscc}(\V{Agnode\_t}_*\V{n},_\V{Agraph\_t}_*\V{scc})_}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{((\V{Agnodeinfo\_t}*)(\V{n}\-\!\>\V{base}.\V{data}))\-\!\>\V{scc}_=_\V{scc};}}
\L{\LB{\}}}
\L{\LB{\K{static}_\K{int}}}
\index{getval}\Proc{getval}\L{\LB{\V{getval}(\V{Agnode\_t}_*\V{n})_}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{return}_(((\V{Agnodeinfo\_t}*)(\V{n}\-\!\>\V{base}.\V{data}))\-\!\>\V{val});}}
\L{\LB{\}}}
\L{\LB{\K{static}_\K{void}_}}
\index{setval}\Proc{setval}\L{\LB{\V{setval}(\V{Agnode\_t}_*\V{n},_\K{int}_\V{v})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{((\V{Agnodeinfo\_t}*)(\V{n}\-\!\>\V{base}.\V{data}))\-\!\>\V{val}_=_\V{v};}}
\L{\LB{\}}}
\L{\LB{\K{\#endif}}}
\L{\LB{}}
\L{\LB{\C{}/*********_stack_***********/\CE{}}}
\L{\LB{\K{typedef}_\K{struct}_\{}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}**}\Tab{15}{\V{data};}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}**}\Tab{15}{\V{ptr};}}
\L{\LB{\}_\V{Stack};}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}}}
\index{initStack}\Proc{initStack}\L{\LB{\V{initStack}_(\V{Stack}*_\V{sp},_\K{int}_\V{sz})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{sp}\-\!\>\V{data}_=_(\V{Agnode\_t}**)\V{malloc}(\V{sz}*\K{sizeof}(\V{Agnode\_t}*));}}
\L{\LB{}\Tab{2}{\V{sp}\-\!\>\V{ptr}_=_\V{sp}\-\!\>\V{data};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}}}
\index{freeStack}\Proc{freeStack}\L{\LB{\V{freeStack}_(\V{Stack}*_\V{sp})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{free}_(\V{sp}\-\!\>\V{data});}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{\#ifdef}_\V{INLINE}}}
\L{\LB{\K{\#define}_\V{push}(\V{sp},\V{n})_(*((\V{sp})\-\!\>\V{ptr}++)_=_\V{n})}}
\L{\LB{\K{\#define}_\V{top}(\V{sp})_(*((\V{sp})\-\!\>\V{ptr}_\-_\N{1}))}}
\L{\LB{\K{\#define}_\V{pop}(\V{sp})_(*(\-\-((\V{sp})\-\!\>\V{ptr})))}}
\L{\LB{\K{\#else}}}
\L{\LB{\K{static}_\K{void}}}
\index{push}\Proc{push}\L{\LB{\V{push}_(\V{Stack}*_\V{sp},_\V{Agnode\_t}*_\V{n})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{*(\V{sp}\-\!\>\V{ptr}++)_=_\V{n};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\V{Agnode\_t}*}}
\index{top}\Proc{top}\L{\LB{\V{top}_(\V{Stack}*_\V{sp})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{return}_*(\V{sp}\-\!\>\V{ptr}_\-_\N{1});}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\V{Agnode\_t}*}}
\index{pop}\Proc{pop}\L{\LB{\V{pop}_(\V{Stack}*_\V{sp})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{sp}\-\!\>\V{ptr}\-\-;}}
\L{\LB{}\Tab{2}{\K{return}_*(\V{sp}\-\!\>\V{ptr});}}
\L{\LB{\}}}
\L{\LB{\K{\#endif}}}
\L{\LB{}}
\L{\LB{}}
\L{\LB{\C{}/*********_end_stack_***********/\CE{}}}
\L{\LB{}}
\L{\LB{\K{typedef}_\K{struct}_\{}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{7}{\V{Comp};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{7}{\V{ID};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{7}{\V{N\_nodes\_in\_nontriv\_SCC};}}
\L{\LB{\}_\V{sccstate};}}
\L{\LB{}}
\L{\LB{\K{int}}\Tab{15}{\V{wantDegenerateComp};}}
\L{\LB{\K{int}}\Tab{15}{\V{Silent};}}
\L{\LB{\K{int}}\Tab{15}{\V{Verbose};}}
\L{\LB{\K{char}*}\Tab{15}{\V{CmdName};}}
\L{\LB{\K{char}**}\Tab{15}{\V{Files};}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}_}}
\index{nodeInduce}\Proc{nodeInduce}\L{\LB{\V{nodeInduce}(\V{Agraph\_t}_*\V{g})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}}\Tab{18}{*\V{n},_*\V{rootn};}}
\L{\LB{}\Tab{2}{\V{Agedge\_t}}\Tab{18}{*\V{e};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{for}_(\V{n}_=_\V{agfstnode}(\V{g});_\V{n};_\V{n}_=_\V{agnxtnode}(\V{n}))_\{}}
\L{\LB{}\Tab{4}{\V{rootn}_=_\V{agsubnode}(\V{agroot}(\V{g}),\V{n},\V{FALSE});}}
\L{\LB{}\Tab{4}{\K{for}_(\V{e}_=_\V{agfstout}(\V{rootn});_\V{e};_\V{e}_=_\V{agnxtout}(\V{e}))_\{}}
\L{\LB{}\Tab{6}{\K{if}_(\V{agsubnode}(\V{g},\V{aghead}(\V{e}),\V{FALSE}))_\V{agsubedge}(\V{g},\V{e},\V{TRUE});}}
\L{\LB{}\Tab{6}{\K{else}_\{}}
\L{\LB{}\Tab{8}{\K{if}_(\V{getscc}(\V{aghead}(\V{e}))_\&\&_\V{getscc}(\V{agtail}(\V{e})))}}
\L{\LB{}\Tab{10}{\V{agedge}(\V{getrep}(\V{getscc}(\V{agtail}(\V{e}))),\V{getrep}(\V{getscc}(\V{aghead}(\V{e}))),}}
\L{\LB{}\Tab{12}{\V{NIL}(\K{char}*),\V{TRUE});}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{int}_}}
\index{visit}\Proc{visit}\L{\LB{\V{visit}(\V{Agnode\_t}_*\V{n},_\V{Agraph\_t}*_\V{map},_\V{Stack}*_\V{sp},_\V{sccstate}*_\V{st})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{unsigned}_\K{int}}\Tab{16}{\V{m},\V{min};}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}*}\Tab{16}{\V{t};}}
\L{\LB{}\Tab{2}{\V{Agraph\_t}*}\Tab{16}{\V{subg};}}
\L{\LB{}\Tab{2}{\V{Agedge\_t}*}\Tab{16}{\V{e};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{min}_=_++(\V{st}\-\!\>\V{ID});}}
\L{\LB{}\Tab{2}{\V{setval}(\V{n},\V{min});}}
\L{\LB{}\Tab{2}{\V{push}_(\V{sp},_\V{n});}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{for}_(\V{e}_=_\V{agfstout}(\V{n});_\V{e};_\V{e}_=_\V{agnxtout}(\V{e}))_\{}}
\L{\LB{}\Tab{4}{\V{t}_=_\V{aghead}(\V{e});}}
\L{\LB{}\Tab{4}{\K{if}_(\V{getval}(\V{t})_==_\N{0})_\V{m}_=_\V{visit}(\V{t},\V{map},\V{sp},\V{st});}}
\L{\LB{}\Tab{4}{\K{else}_\V{m}_=_\V{getval}(\V{t});}}
\L{\LB{}\Tab{4}{\K{if}_(\V{m}_\<_\V{min})_\V{min}_=_\V{m};}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{if}_(\V{getval}(\V{n})_==_\V{min})_\{}}
\L{\LB{}\Tab{4}{\K{if}_(!\V{wantDegenerateComp}_\&\&_(\V{top}(\V{sp})_==_\V{n}))_\{}}
\L{\LB{}\Tab{6}{\V{setval}(\V{n},\V{INF});}}
\L{\LB{}\Tab{6}{\V{pop}(\V{sp});}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\K{else}_\{}}
\L{\LB{}\Tab{6}{\K{char}_\V{name}[\N{32}];}}
\L{\LB{}\Tab{6}{\V{Agraph\_t}*}\Tab{18}{\V{G}_=_\V{agraphof}(\V{n});;}}
\L{\LB{}\Tab{6}{\V{sprintf}(\V{name},\S{}\3cluster\_\%d\3\SE{},(\V{st}\-\!\>\V{Comp})++);}}
\L{\LB{}\Tab{6}{\V{subg}_=_\V{agsubg}(\V{G},\V{name},\V{TRUE});}}
\L{\LB{}\Tab{6}{\V{agbindrec}(\V{subg},\S{}\3scc\_graph\3\SE{},\K{sizeof}(\V{Agraphinfo\_t}),\V{TRUE});}}
\L{\LB{}\Tab{6}{\V{setrep}(\V{subg},\V{agnode}(\V{map},\V{name},\V{TRUE}));}}
\L{\LB{}\Tab{6}{\K{do}_\{}}
\L{\LB{}\Tab{8}{\V{t}_=_\V{pop}(\V{sp});}}
\L{\LB{}\Tab{8}{\V{agsubnode}(\V{subg},\V{t},\V{TRUE});}}
\L{\LB{}\Tab{8}{\V{setval}(\V{t},\V{INF});}}
\L{\LB{}\Tab{8}{\V{setscc}(\V{t},\V{subg});}}
\L{\LB{}\Tab{8}{\V{st}\-\!\>\V{N\_nodes\_in\_nontriv\_SCC}++;}}
\L{\LB{}\Tab{6}{\}_\K{while}_(\V{t}_!=_\V{n});}}
\L{\LB{}\Tab{6}{\V{nodeInduce}(\V{subg});}}
\L{\LB{}\Tab{6}{\K{if}_(!\V{Silent})_\V{agwrite}(\V{subg},\V{stdout});}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\K{return}_\V{min};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{int}_}}
\index{label}\Proc{label}\L{\LB{\V{label}(\V{Agnode\_t}_*\V{n},_\K{int}_\V{nodecnt},_\K{int}*_\V{edgecnt})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{Agedge\_t}}\Tab{14}{*\V{e};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{setval}(\V{n},\N{1});}}
\L{\LB{}\Tab{2}{\V{nodecnt}++;}}
\L{\LB{}\Tab{2}{\K{for}_(\V{e}_=_\V{agfstedge}(\V{n});_\V{e};_\V{e}_=_\V{agnxtedge}(\V{e},\V{n}))_\{}}
\L{\LB{}\Tab{4}{(*\V{edgecnt})_+=_\N{1};}}
\L{\LB{}\Tab{4}{\K{if}_(\V{e}\-\!\>\V{node}_==_\V{n})_\V{e}_=_\V{agopp}(\V{e});}}
\L{\LB{}\Tab{4}{\K{if}_(!\V{getval}(\V{e}\-\!\>\V{node}))}}
\L{\LB{}\Tab{6}{\V{nodecnt}_=_\V{label}(\V{e}\-\!\>\V{node},\V{nodecnt},\V{edgecnt});}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\K{return}_\V{nodecnt};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{int}_}}
\index{countComponents}\Proc{countComponents}\L{\LB{\V{countComponents}(\V{Agraph\_t}_*\V{g},_\K{int}*_\V{max\_degree},_\K{float}_*\V{nontree\_frac})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{nc}_=_\N{0};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{sum\_edges}_=_\N{0};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{sum\_nontree}_=_\N{0};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{deg};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{n\_edges};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{13}{\V{n\_nodes};}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}*}\Tab{13}{\V{n};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{for}_(\V{n}_=_\V{agfstnode}(\V{g});_\V{n};_\V{n}_=_\V{agnxtnode}(\V{n}))_\{}}
\L{\LB{}\Tab{4}{\K{if}_(!\V{getval}(\V{n}))_\{}}
\L{\LB{}\Tab{6}{\V{nc}++;}}
\L{\LB{}\Tab{6}{\V{n\_edges}_=_\N{0};}}
\L{\LB{}\Tab{6}{\V{n\_nodes}_=_\V{label}(\V{n},\N{0},\&\V{n\_edges});}}
\L{\LB{}\Tab{6}{\V{sum\_edges}_+=_\V{n\_edges};}}
\L{\LB{}\Tab{6}{\V{sum\_nontree}_+=_(\V{n\_edges}_\-_\V{n\_nodes}_+_\N{1});}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\K{if}_(\V{max\_degree})_\{}}
\L{\LB{}\Tab{4}{\K{int}_\V{maxd}_=_\N{0};}}
\L{\LB{}\Tab{4}{\K{for}_(\V{n}_=_\V{agfstnode}(\V{g});_\V{n};_\V{n}_=_\V{agnxtnode}(\V{n}))_\{}}
\L{\LB{}\Tab{6}{\V{deg}_=_\V{agdegree}(\V{n},\V{TRUE},\V{TRUE});}}
\L{\LB{}\Tab{6}{\K{if}_(\V{maxd}_\<_\V{deg})_\V{maxd}_=_\V{deg};}}
\L{\LB{}\Tab{6}{\V{setval}(\V{n},\N{0});}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{*\V{max\_degree}_=_\V{maxd};}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\K{if}_(\V{nontree\_frac})_\{}}
\L{\LB{}\Tab{4}{\K{if}_(\V{sum\_edges}_\>_\N{0})_*\V{nontree\_frac}_=_(\K{float})\V{sum\_nontree}_/_(\K{float})\V{sum\_edges};}}
\L{\LB{}\Tab{4}{\K{else}_*\V{nontree\_frac}_=_\N{0.0};}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\K{return}_\V{nc};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}_}}
\index{process}\Proc{process}\L{\LB{\V{process}(\V{Agraph\_t}*_\V{G})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{Agnode\_t}*}\Tab{15}{\V{n};}}
\L{\LB{}\Tab{2}{\V{Agraph\_t}*}\Tab{15}{\V{map};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{15}{\V{nc}_=_\N{0};}}
\L{\LB{}\Tab{2}{\K{float}}\Tab{15}{\V{nontree\_frac};}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{15}{\V{Maxdegree};}}
\L{\LB{}\Tab{2}{\V{Stack}}\Tab{15}{\V{stack};}}
\L{\LB{}\Tab{2}{\V{sccstate}}\Tab{15}{\V{state};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{aginit}(\V{G},\V{AGRAPH},\S{}\3scc\_graph\3\SE{},\K{sizeof}(\V{Agraphinfo\_t}),\V{TRUE});}}
\L{\LB{}\Tab{2}{\V{aginit}(\V{G},\V{AGNODE},\S{}\3scc\_node\3\SE{},\K{sizeof}(\V{Agnodeinfo\_t}),\V{TRUE});}}
\L{\LB{}\Tab{2}{\V{state}.\V{Comp}_=_\V{state}.\V{ID}_=_\N{0};}}
\L{\LB{}\Tab{2}{\V{state}.\V{N\_nodes\_in\_nontriv\_SCC}_=_\N{0};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{if}_(\V{Verbose})}}
\L{\LB{}\Tab{4}{\V{nc}_=_\V{countComponents}(\V{G},\&\V{Maxdegree},\&\V{nontree\_frac});}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{initStack}(\&\V{stack},_\V{agnnodes}(\V{G})_+_\N{1});}}
\L{\LB{}\Tab{2}{\V{map}_=_\V{agopen}(\S{}\3scc\_map\3\SE{},\V{Agdirected},(\V{Agdisc\_t}_*)\N{0});}}
\L{\LB{}\Tab{2}{\K{for}_(\V{n}_=_\V{agfstnode}(\V{G});_\V{n};_\V{n}_=_\V{agnxtnode}(\V{n}))}}
\L{\LB{}\Tab{4}{\K{if}_(\V{getval}(\V{n})_==_\N{0})_\V{visit}(\V{n},\V{map},\&\V{stack},\&\V{state});}}
\L{\LB{}\Tab{2}{\V{freeStack}(\&\V{stack});}}
\L{\LB{}\Tab{2}{\K{if}_(!\V{Silent})_\V{agwrite}(\V{map},\V{stdout});}}
\L{\LB{}\Tab{2}{\V{agclose}(\V{map});}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{if}_(\V{Verbose})_}}
\L{\LB{}\Tab{4}{\V{fprintf}(\V{stderr},\S{}\3\%d_\%d_\%d_\%d_\%.4f_\%d_\%.4f\2n\3\SE{},}}
\L{\LB{}\Tab{6}{\V{agnnodes}(\V{G}),_\V{agnedges}(\V{G}),_\V{nc},_\V{state}.\V{Comp},}}
\L{\LB{}\Tab{6}{\V{state}.\V{N\_nodes\_in\_nontriv\_SCC}_/_(\K{double})_\V{agnnodes}(\V{G}),_\V{Maxdegree},}}
\L{\LB{}\Tab{6}{\V{nontree\_frac});}}
\L{\LB{}\Tab{2}{\K{else}}}
\L{\LB{}\Tab{4}{\V{fprintf}(\V{stderr},\S{}\3\%d_nodes,_\%d_edges,_\%d_strong_components\2n\3\SE{},}}
\L{\LB{}\Tab{6}{\V{agnnodes}(\V{G}),_\V{agnedges}(\V{G}),_\V{state}.\V{Comp});}}
\L{\LB{}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{char}*_\V{useString}_=_}}
\L{\LB{\S{}\3Usage:_\%s_[\-sdv?]_\<files\>\2n\2}}
\L{\LB{}\Tab{2}{\-s_\-_silent\2n\2}}
\L{\LB{}\Tab{2}{\-d_\-_allow_degenerate_components\2n\2}}
\L{\LB{}\Tab{2}{\-v_\-_verbose\2n\2}}
\L{\LB{}\Tab{2}{\-?_\-_print_usage\2n\2}}
\L{\LB{If_no_files_are_specified,_stdin_is_used\2n\3\SE{};}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}}}
\index{usage}\Proc{usage}\L{\LB{\V{usage}_(\K{int}_\V{v})}}
\L{\LB{\{}}
\L{\LB{}\Tab{4}{\V{printf}_(\V{useString},_\V{CmdName});}}
\L{\LB{}\Tab{4}{\V{exit}_(\V{v});}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\K{void}}}
\index{scanArgs}\Proc{scanArgs}\L{\LB{\V{scanArgs}(\K{int}_\V{argc},\K{char}_**\V{argv})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{int}}\Tab{17}{\V{c};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{CmdName}_=_\V{argv}[\N{0}];}}
\L{\LB{}\Tab{2}{\K{while}_((\V{c}_=_\V{getopt}(\V{argc},\V{argv},\S{}\3:?sdv\3\SE{}))_!=_\V{EOF})_\{}}
\L{\LB{}\Tab{4}{\K{switch}_(\V{c})_\{}}
\L{\LB{}\Tab{4}{\K{case}_\S{}{'}s{'}\SE{}:_}}
\L{\LB{}\Tab{6}{\V{Silent}_=_\N{1};_\K{break};}}
\L{\LB{}\Tab{4}{\K{case}_\S{}{'}d{'}\SE{}:_}}
\L{\LB{}\Tab{6}{\V{wantDegenerateComp}_=_\N{1};_\K{break};}}
\L{\LB{}\Tab{4}{\K{case}_\S{}{'}v{'}\SE{}:_}}
\L{\LB{}\Tab{6}{\V{Verbose}_=_\N{1};_\K{break};}}
\L{\LB{}\Tab{4}{\K{case}_\S{}{'}?{'}\SE{}:}}
\L{\LB{}\Tab{6}{\K{if}_(\V{optopt}_==_\S{}{'}?{'}\SE{})_\V{usage}(\N{0});}}
\L{\LB{}\Tab{6}{\K{else}_\V{fprintf}(\V{stderr},\S{}\3\%s:_option_\-\%c_unrecognized_\-_ignored\2n\3\SE{},_}}
\L{\LB{}\Tab{8}{\V{CmdName},_\V{c});}}
\L{\LB{}\Tab{6}{\K{break};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}\Tab{2}{\V{argv}_+=_\V{optind};}}
\L{\LB{}\Tab{2}{\V{argc}_\-=_\V{optind};}}
\L{\LB{}\Tab{2}{}}
\L{\LB{}\Tab{2}{\K{if}_(\V{argc})_\V{Files}_=_\V{argv};}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{static}_\V{Agraph\_t}*}}
\index{gread}\Proc{gread}\L{\LB{\V{gread}_(\V{FILE}*_\V{fp})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\K{return}_\V{agread}(\V{fp},(\V{Agdisc\_t}*)\N{0});}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{int}_}}
\index{main}\Proc{main}\L{\LB{\V{main}(\K{int}_\V{argc},_\K{char}_**\V{argv})}}
\L{\LB{\{}}
\L{\LB{}\Tab{2}{\V{Agraph\_t}*}\Tab{16}{\V{g};}}
\L{\LB{}\Tab{2}{\V{ingraph\_state}_\V{ig};}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\V{scanArgs}(\V{argc},\V{argv});}}
\L{\LB{}\Tab{2}{\V{newIngraph}_(\&\V{ig},_\V{Files},_\V{gread});}}
\L{\LB{}\Tab{2}{}}
\L{\LB{}\Tab{2}{\K{while}_((\V{g}_=_\V{nextGraph}(\&\V{ig}))_!=_\N{0})_\{}}
\L{\LB{}\Tab{4}{\K{if}_(\V{agisdirected}(\V{g}))_\V{process}_(\V{g});}}
\L{\LB{}\Tab{4}{\K{else}_\V{fprintf}_(\V{stderr},_\S{}\3Graph_\%s_in_\%s_is_undirected_\-_ignored\2n\3\SE{},_}}
\L{\LB{}\Tab{6}{\V{agnameof}(\V{g}),_\V{fileName}(\&\V{ig}));}}
\L{\LB{}\Tab{4}{\V{agclose}_(\V{g});}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{return}_\N{0};}}
\L{\LB{\}}}
\L{\LB{}}
